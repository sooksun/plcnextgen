# การติดตั้งบน Ubuntu Server 24.x.x (Docker Compose)

## 1. ติดตั้งบน Ubuntu Server 24.x.x ด้วย Docker Compose — **ได้**

### ความต้องการ
- Ubuntu Server 24.04 LTS (หรือ 24.x.x)
- Docker และ Docker Compose v2

### ขั้นตอน

```bash
# ติดตั้ง Docker (ถ้ายังไม่มี)
curl -fsSL https://get.docker.com | sh
sudo usermod -aG docker $USER
# ออกจาก shell แล้ว login ใหม่

# ติดตั้ง Docker Compose plugin (รวมใน Docker ใหม่แล้ว)
docker compose version
```

คลอนโปรเจกต์แล้วเข้าโฟลเดอร์:

```bash
cd /path/to/plcnextgen
```

สร้างไฟล์ `.env` จากค่าที่ใช้อยู่ (หรือคัดลอกจาก `.env` ในเครื่องพัฒนา):

```bash
# ต้องมี 2 ค่านี้เพื่อ build (Vite จะฝังลงในแอป)
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key
```

Build และรัน:

```bash
docker compose up -d --build
```

เปิดใช้ที่ `http://<IP-server>:3000` (หรือพอร์ตที่ map ใน `docker-compose.yml`)

หยุด:

```bash
docker compose down
```

---

## 2. บันทึกเสียงการประชุม 1–2 ชั่วโมง — **ได้แต่มีข้อจำกัด**

- **ตอนนี้**: แอปใช้ **Web Speech API** (ถอดเสียงในเบราว์เซอร์) **ไม่มีการบันทึกไฟล์เสียง**  
  มีเฉพาะ **ข้อความถอดเสียง (transcript)** แบบ real-time และไม่มีตัวจำกัดเวลาในโค้ด (จับได้เรื่อยๆ ตามที่เบราว์เซอร์รองรับ)

- **ข้อจำกัดที่อาจเจอเมื่อบันทึกยาว 1–2 ชม.**
  - เบราว์เซอร์หรือบริการถอดเสียงอาจตัดเซสชัน (timeout / reconnect)
  - แท็บอาจถูกปิดหรือเบราว์เซอร์คืนหน่วยความจำ
  - การเชื่อมต่อเน็ตไม่เสถียรอาจทำให้ขาดช่วง

**แนวทางถ้าต้องการประชุมยาว 1–2 ชม. แนะนำ**  
- แบ่งบันทึกเป็นช่วง (เช่น 30–45 นาที) แล้วกดหยุดแล้วเริ่มใหม่ หรือ  
- พัฒนาต่อ: บันทึกไฟล์เสียงจริง (MediaRecorder) แล้วส่งไปถอดเสียงที่เซิร์ฟเวอร์ (เช่น Supabase + Edge Function เรียก STT API) เพื่อรองรับความยาวและความเสถียรที่ดีขึ้น

---

## 3. การบันทึกข้อมูล — **มีเฉพาะข้อความถอดเสียง ไม่มีไฟล์เสียง**

| ประเภทข้อมูล        | บันทึกหรือไม่ | รายละเอียด |
|---------------------|---------------|------------|
| **ไฟล์เสียง (audio)** | **ไม่บันทึก** | ไม่มีการอัดหรือเก็บไฟล์เสียงในแอปและใน Supabase |
| **ข้อความถอดเสียง (transcript)** | **บันทึก** | เก็บเฉพาะข้อความที่ถอดจากเสียง |

**ที่เก็บข้อความถอดเสียง**
- หลังกด "บันทึกและดูสรุป": เก็บใน **Supabase** ตาราง `notes` (ฟิลด์ `content`, `transcript`) และถ้า Supabase ไม่ใช้ได้จะ fallback ไป **localStorage** (เบราว์เซอร์)
- ก่อนกดบันทึก: ข้อความชั่วคราวอยู่ใน **localStorage** (`temp_transcript`) ในเบราว์เซอร์เท่านั้น

**สรุป**: ไม่มีการบันทึกข้อมูลเสียง มีเฉพาะการบันทึก **ข้อความที่ถอดจากเสียง** ลง Supabase หรือ localStorage ตามที่อธิบายข้างต้น
